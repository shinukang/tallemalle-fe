<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>탈래말래 - 마이페이지</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- nav.js 연결 -->
  <script src="nav.js"></script>

  <style>
    @import url("https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700;800&display=swap");

    body {
      font-family: "Pretendard", sans-serif;
      background-color: #f8fafc;
    }

    .glass-panel {
      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0 8px 32px rgba(30, 27, 75, 0.05);
    }

    .custom-scroll::-webkit-scrollbar {
      width: 5px;
    }

    .custom-scroll::-webkit-scrollbar-thumb {
      background: #e2e8f0;
      border-radius: 10px;
    }

    .score-gradient {
      background: linear-gradient(90deg, #6366f1 0%, #a855f7 100%);
    }

    /* 탭 전환 애니메이션 */
    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease-out;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* 모달 애니메이션 */
    #rideHistoryModal, #viewReviewModal {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0;
      pointer-events: none;
      visibility: hidden;
      display: flex;
    }

    #rideHistoryModal.active, #viewReviewModal.active {
      opacity: 1;
      pointer-events: auto;
      visibility: visible;
    }

    .modal-content {
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      transform: translateY(40px);
    }

    .active .modal-content {
      transform: translateY(0);
    }

    .route-line {
      position: relative;
    }

    .route-line::before {
      content: '';
      position: absolute;
      left: 7px;
      top: 20px;
      bottom: 20px;
      width: 2px;
      background: #e2e8f0;
      border-radius: 2px;
    }
  </style>
</head>

<body class="overflow-hidden">
  <div class="flex h-screen p-4 gap-4">

    <!-- 네비게이션 컨테이너 -->
    <div id="navbar-container" class="w-20 h-full shrink-0 rounded-[2.5rem]"></div>

    <!-- 메인 콘텐츠 영역 -->
    <div class="flex-1 glass-panel rounded-[2.5rem] overflow-hidden flex flex-col">
      <!-- 상단 타이틀 및 설명 -->
      <div class="p-8 border-b border-slate-100 flex justify-between items-center bg-white/50">
        <div>
          <h1 class="text-2xl font-extrabold text-slate-900 tracking-tight">마이페이지</h1>
          <p class="text-sm text-slate-400 font-medium mt-1">나의 동승 기록과 프로필 정보를 한눈에 관리하세요.</p>
        </div>
        <div class="flex gap-4">
            <div class="text-right">
                <p class="text-[10px] font-bold text-slate-400 uppercase">누적 동승</p>
                <p class="text-lg font-black text-indigo-600">128회</p>
            </div>
            <div class="w-px h-8 bg-slate-200 self-center"></div>
            <div class="text-right">
                <p class="text-[10px] font-bold text-slate-400 uppercase">절약 금액</p>
                <p class="text-lg font-black text-emerald-600">24.5만</p>
            </div>
        </div>
      </div>

      <div class="flex-1 overflow-y-auto custom-scroll p-8">
        <div class="max-w-6xl mx-auto grid grid-cols-12 gap-8">

          <!-- 좌측 사이드바 -->
          <div class="col-span-12 lg:col-span-4 space-y-6 flex flex-col">
            <!-- 프로필 카드 -->
            <div class="bg-white rounded-[2.5rem] p-8 border border-slate-100 shadow-sm text-center relative overflow-hidden">
              <div class="absolute top-0 left-0 w-full h-24 bg-slate-50"></div>
              <div class="relative w-28 h-28 mx-auto mb-4 mt-4">
                <img id="profilePreview" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="profile"
                  class="w-full h-full rounded-full bg-white border-4 border-white shadow-xl object-cover" />
                <input type="file" id="imageInput" accept="image/*" class="hidden" />
                <button id="uploadButton" type="button"
                  class="absolute bottom-1 right-1 p-2.5 bg-indigo-600 text-white rounded-full shadow-lg border-2 border-white hover:bg-indigo-700 transition-colors">
                  <i data-lucide="camera" class="w-4 h-4"></i>
                </button>
              </div>
              <h2 class="text-xl font-bold text-slate-900">판교동승왕님</h2>
              <p class="text-xs text-slate-400 mb-6">pangyo_king@gmail.com</p>
              <button onclick="location.href='changeProfile.html'"
                class="w-full py-3.5 bg-slate-900 text-white rounded-2xl font-bold text-sm hover:bg-indigo-600 transition-all active:scale-95 shadow-lg shadow-indigo-100">
                개인정보 수정
              </button>
            </div>

            <!-- 매너 점수 시스템 -->
            <div class="bg-white rounded-[2.5rem] p-7 border border-slate-100 shadow-sm">
              <div class="flex justify-between items-start mb-4">
                <div>
                  <span class="text-[10px] font-extrabold text-slate-400 uppercase tracking-widest block mb-1">나의 매너 등급</span>
                  <div class="flex items-baseline gap-1">
                    <span class="text-4xl font-black text-indigo-600 tracking-tighter">85</span>
                    <span class="text-sm font-bold text-slate-300">/ 100</span>
                  </div>
                </div>
                <div class="bg-indigo-50 p-3 rounded-2xl">
                    <i data-lucide="sparkles" class="w-6 h-6 text-indigo-600"></i>
                </div>
              </div>
              <div class="w-full h-3 bg-slate-100 rounded-full overflow-hidden mb-4">
                <div class="score-gradient h-full rounded-full shadow-sm" style="width: 85%"></div>
              </div>
              <div class="flex justify-between text-[10px] font-bold text-slate-300">
                  <span>기본 50점</span>
                  <span class="text-indigo-400">BEST 100점</span>
              </div>
              <p class="text-[11px] text-slate-400 mt-4 leading-relaxed text-center font-medium">
                평점 4.8/5.0 <span class="text-indigo-600">상위 5%</span>의 매너를 가진 이용자입니다!
              </p>
            </div>

            <div class="flex-1"></div>

            <!-- 회원탈퇴 버튼 -->
            <div class="pt-4 flex justify-center mt-auto">
                <button class="flex items-center gap-1.5 text-slate-300 hover:text-rose-500 transition-all font-bold text-[11px]">
                    <i data-lucide="user-minus" class="w-3.5 h-3.5"></i>
                    탈래말래 탈퇴하기
                </button>
            </div>
          </div>

          <!-- 우측 메인 영역 -->
          <div class="col-span-12 lg:col-span-8 space-y-6">
            <!-- 결제 수단 카드 -->
            <div class="bg-white rounded-[2.5rem] p-8 border border-slate-100 shadow-sm">
              <div class="flex items-center justify-between mb-6">
                <h3 class="font-bold text-slate-900 flex items-center gap-2">
                  <i data-lucide="credit-card" class="w-5 h-5 text-indigo-600"></i> 나의 결제 수단
                </h3>
                <button class="px-4 py-2 bg-indigo-50 text-indigo-600 rounded-xl text-xs font-bold hover:bg-indigo-100 transition-all" onclick="location.href='editPayment.html'">카드 추가</button>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="flex items-center justify-between p-5 bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl text-white shadow-xl shadow-slate-200">
                  <div class="flex items-center gap-4">
                    <div class="w-10 h-7 bg-white/10 rounded flex items-center justify-center text-[8px] font-black italic">VISA</div>
                    <div>
                      <p class="text-xs font-bold">신한카드 (4215)</p>
                      <p class="text-[10px] text-slate-400">기본 결제 수단</p>
                    </div>
                  </div>
                  <i data-lucide="check-circle-2" class="w-5 h-5 text-indigo-400"></i>
                </div>
              </div>
            </div>

            <!-- 탭 전환 컨텐츠 영역 -->
            <div class="bg-white rounded-[2.5rem] border border-slate-100 shadow-sm overflow-hidden flex flex-col min-h-[500px]">
              <!-- 탭 헤더 -->
              <div class="flex border-b border-slate-50">
                <button id="tab-history" onclick="switchTab('history')"
                  class="flex-1 py-6 text-sm font-bold border-b-2 border-indigo-600 text-indigo-600 bg-indigo-50/30 transition-all">
                  최근 탑승 기록
                </button>
                <button id="tab-reviews" onclick="switchTab('reviews')"
                  class="flex-1 py-6 text-sm font-bold border-b-2 border-transparent text-slate-400 hover:text-slate-600 bg-white transition-all">
                  받은 리뷰 <span class="ml-1 text-[10px] bg-slate-100 px-1.5 py-0.5 rounded-md">12</span>
                </button>
              </div>

              <!-- 탭 1: 탑승 기록 리스트 -->
              <div id="content-history" class="tab-content active flex-1 overflow-y-auto custom-scroll p-6 space-y-4">
                <!-- 기록 아이템 1 -->
                <div onclick="openRideDetail(1)"
                  class="flex items-center gap-5 p-5 hover:bg-slate-50 border border-transparent hover:border-slate-100 rounded-3xl transition-all cursor-pointer group">
                  <div class="w-14 h-14 bg-indigo-50 rounded-2xl flex items-center justify-center text-indigo-600 shrink-0 group-hover:scale-110 transition-transform">
                    <i data-lucide="map-pin" class="w-6 h-6"></i>
                  </div>
                  <div class="flex-1">
                    <div class="flex justify-between items-start mb-1">
                      <p class="text-sm font-bold text-slate-800">강남역 2번 출구 → 판교역</p>
                      <span class="text-[10px] font-bold text-slate-400 bg-slate-100 px-2 py-0.5 rounded">어제</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <p class="text-xs text-slate-400 font-medium">4,500원 결제 · 동승 4명</p>
                        <span class="w-1 h-1 bg-slate-200 rounded-full"></span>
                        <p class="text-xs text-indigo-500 font-bold italic">정산 완료</p>
                    </div>
                  </div>
                  <i data-lucide="arrow-right" class="w-5 h-5 text-slate-200 group-hover:text-indigo-600 transform translate-x-0 group-hover:translate-x-1 transition-all"></i>
                </div>

                <!-- 기록 아이템 2 -->
                <div onclick="openRideDetail(2)"
                  class="flex items-center gap-5 p-5 hover:bg-slate-50 border border-transparent hover:border-slate-100 rounded-3xl transition-all cursor-pointer group">
                  <div class="w-14 h-14 bg-slate-100 rounded-2xl flex items-center justify-center text-slate-400 shrink-0 group-hover:scale-110 transition-transform">
                    <i data-lucide="map-pin" class="w-6 h-6"></i>
                  </div>
                  <div class="flex-1">
                    <div class="flex justify-between items-start mb-1">
                      <p class="text-sm font-bold text-slate-800">합정역 → 서울역</p>
                      <span class="text-[10px] font-bold text-slate-400 bg-slate-100 px-2 py-0.5 rounded">3일 전</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <p class="text-xs text-slate-400 font-medium">3,200원 결제 · 동승 2명</p>
                        <span class="w-1 h-1 bg-slate-200 rounded-full"></span>
                        <p class="text-xs text-indigo-500 font-bold italic">정산 완료</p>
                    </div>
                  </div>
                  <i data-lucide="arrow-right" class="w-5 h-5 text-slate-200 group-hover:text-indigo-600 transform translate-x-0 group-hover:translate-x-1 transition-all"></i>
                </div>
              </div>

              <!-- 탭 2: 받은 리뷰 리스트 -->
              <div id="content-reviews" class="tab-content flex-1 overflow-y-auto custom-scroll p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- 리뷰 카드 1 -->
                    <div class="p-6 bg-slate-50 rounded-[2rem] border border-slate-100 relative group hover:bg-white hover:shadow-xl hover:shadow-indigo-50 transition-all">
                        <div class="flex items-center gap-3 mb-4">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Luna" class="w-10 h-10 rounded-full bg-white border">
                            <div>
                                <p class="text-xs font-bold text-slate-800">루나님</p>
                                <p class="text-[10px] text-slate-400">강남역 → 판교역 동승</p>
                            </div>
                        </div>
                        <i data-lucide="quote" class="absolute top-6 right-6 w-4 h-4 text-slate-200"></i>
                        <p class="text-sm text-slate-600 leading-relaxed italic">"시간 약속을 정말 칼같이 지키셔서 너무 좋았어요! 매너도 최고십니다."</p>
                        <div class="mt-4 flex gap-1">
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                        </div>
                    </div>

                    <!-- 리뷰 카드 2 -->
                    <div class="p-6 bg-slate-50 rounded-[2rem] border border-slate-100 relative group hover:bg-white hover:shadow-xl hover:shadow-indigo-50 transition-all">
                        <div class="flex items-center gap-3 mb-4">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Kai" class="w-10 h-10 rounded-full bg-white border">
                            <div>
                                <p class="text-xs font-bold text-slate-800">카이님</p>
                                <p class="text-[10px] text-slate-400">합정역 → 서울역 동승</p>
                            </div>
                        </div>
                        <i data-lucide="quote" class="absolute top-6 right-6 w-4 h-4 text-slate-200"></i>
                        <p class="text-sm text-slate-600 leading-relaxed italic">"조용하게 이동하고 싶었는데 딱 배려해주셔서 편안하게 왔습니다. 감사해요!"</p>
                        <div class="mt-4 flex gap-1">
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                            <i data-lucide="star" class="w-3 h-3 fill-amber-400 text-amber-400"></i>
                        </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- [팝업 모달] 탑승 기록 상세 -->
  <div id="rideHistoryModal"
    class="fixed inset-0 z-[100] flex items-center justify-center p-6 bg-slate-900/40 backdrop-blur-md">
    <div
      class="modal-content glass-panel w-full max-w-lg rounded-[3rem] overflow-hidden pointer-events-auto shadow-2xl flex flex-col max-h-[90vh]">
      <div class="p-8 border-b border-slate-100 flex items-center justify-between bg-white/50">
        <div>
          <h2 class="text-xl font-bold text-slate-900 tracking-tight">탑승 상세 요약</h2>
          <p id="modalDate" class="text-[11px] text-slate-400 font-bold uppercase tracking-wider mt-1">2024.03.20 탑승</p>
        </div>
        <button onclick="closeRideDetail()" class="p-2 hover:bg-slate-100 rounded-2xl transition-colors text-slate-400">
          <i data-lucide="x" class="w-6 h-6"></i>
        </button>
      </div>
      <div id="rideHistoryContent" class="flex-1 overflow-y-auto custom-scroll p-8 space-y-10 text-slate-800">
        <!-- JS 동적 내용 -->
      </div>
      <div class="p-8 bg-slate-50/50 border-t border-slate-100">
        <button onclick="closeRideDetail()"
          class="w-full py-5 bg-slate-900 text-white rounded-[1.5rem] font-bold hover:bg-indigo-600 transition-all shadow-xl active:scale-95">확인 완료</button>
      </div>
    </div>
  </div>

  <!-- [추가된 팝업 모달] 내가 쓴 리뷰 보기 -->
  <div id="viewReviewModal"
    class="fixed inset-0 z-[110] flex items-center justify-center p-6 bg-slate-900/60 backdrop-blur-md">
    <div
      class="modal-content bg-white w-full max-w-sm rounded-[2.5rem] overflow-hidden shadow-2xl flex flex-col p-8 text-center">
      <div class="w-16 h-16 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-6">
          <i data-lucide="message-square-text" class="w-8 h-8"></i>
      </div>
      <h3 class="text-xl font-bold text-slate-900 mb-2">내가 남긴 리뷰</h3>
      <p id="reviewTargetName" class="text-xs text-slate-400 font-bold mb-6 uppercase tracking-wider">To. Partner</p>
      
      <div class="bg-slate-50 rounded-3xl p-6 mb-8 text-left relative">
          <i data-lucide="quote" class="absolute top-4 right-4 w-4 h-4 text-slate-200"></i>
          <p id="myReviewText" class="text-sm text-slate-600 leading-relaxed font-medium italic">"리뷰 내용을 불러오고 있습니다."</p>
          <div id="myReviewStars" class="mt-4 flex gap-1 justify-start">
              <!-- 별점 렌더링 영역 -->
          </div>
      </div>

      <button onclick="closeReviewModal()"
        class="w-full py-4 bg-slate-900 text-white rounded-2xl font-bold hover:bg-indigo-600 transition-all shadow-lg active:scale-95">닫기</button>
    </div>
  </div>

  <script>
    // 탑승 기록 데이터 (리뷰 상태 추가)
    const rideHistory = {
      1: {
        start: "강남역 2번 출구", dest: "판교역", date: "2024.03.24 (일)", startTime: "18:30", endTime: "18:52",
        distance: "12.4 km", duration: "22분", 
        partners: [
          { name: "Felix", reviewed: true, content: "시간 약속을 정말 칼같이 지키셔서 너무 좋았어요! 매너도 최고십니다.", stars: 5 },
          { name: "Luna", reviewed: false },
          { name: "Kai", reviewed: false }
        ],
        taxiModel: "그랜저 (모범)", taxiNumber: "서울 34 바 1234", driverName: "김철수 기사님",
        payment: "신한카드 (4215)", totalCost: "18,000원", cost: "4,500원"
      },
      2: {
        start: "합정역 7번 출구", dest: "서울역", date: "2024.03.21 (목)", startTime: "21:15", endTime: "21:30",
        distance: "7.2 km", duration: "15분", 
        partners: [
          { name: "Chloe", reviewed: true, content: "조용히 갈 수 있어서 너무 좋았어요. 감사해요!", stars: 4 },
          { name: "James", reviewed: false }
        ],
        taxiModel: "쏘나타 (중형)", taxiNumber: "경기 12 가 5678", driverName: "이영희 기사님",
        payment: "현대카드 (1004)", totalCost: "9,600원", cost: "3,200원"
      }
    };

    window.onload = function () {
      if (typeof loadNavbar === 'function') {
        loadNavbar('nav-mypage');
      }
      lucide.createIcons();
    };

    function switchTab(tabName) {
      const historyTab = document.getElementById('tab-history');
      const reviewsTab = document.getElementById('tab-reviews');
      const historyContent = document.getElementById('content-history');
      const reviewsContent = document.getElementById('content-reviews');

      if (tabName === 'history') {
        historyTab.classList.add('border-indigo-600', 'text-indigo-600', 'bg-indigo-50/30');
        historyTab.classList.remove('border-transparent', 'text-slate-400', 'bg-white');
        reviewsTab.classList.remove('border-indigo-600', 'text-indigo-600', 'bg-indigo-50/30');
        reviewsTab.classList.add('border-transparent', 'text-slate-400', 'bg-white');
        historyContent.classList.add('active');
        reviewsContent.classList.remove('active');
      } else {
        reviewsTab.classList.add('border-indigo-600', 'text-indigo-600', 'bg-indigo-50/30');
        reviewsTab.classList.remove('border-transparent', 'text-slate-400', 'bg-white');
        historyTab.classList.remove('border-indigo-600', 'text-indigo-600', 'bg-indigo-50/30');
        historyTab.classList.add('border-transparent', 'text-slate-400', 'bg-white');
        reviewsContent.classList.add('active');
        historyContent.classList.remove('active');
      }
      lucide.createIcons();
    }

    function openRideDetail(id) {
      const data = rideHistory[id];
      if (!data) return;
      const contentEl = document.getElementById('rideHistoryContent');
      document.getElementById('modalDate').innerText = `${data.date} 탑승 정보`;

      contentEl.innerHTML = `
          <div class="route-line space-y-8">
            <div class="flex items-start gap-4">
              <div class="w-4 h-4 rounded-full bg-emerald-500 border-4 border-emerald-100 shrink-0 mt-1 relative z-10"></div>
              <div><span class="text-[10px] font-bold text-slate-400 uppercase block mb-0.5">출발 (${data.startTime})</span><p class="font-bold">${data.start}</p></div>
            </div>
            <div class="flex items-start gap-4">
              <div class="w-4 h-4 rounded-full bg-rose-500 border-4 border-rose-100 shrink-0 mt-1 relative z-10"></div>
              <div><span class="text-[10px] font-bold text-slate-400 uppercase block mb-0.5">도착 (${data.endTime})</span><p class="font-bold">${data.dest}</p></div>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-slate-50 p-5 rounded-2xl border border-slate-100 col-span-2 space-y-3">
                <div class="flex items-center gap-2"><i data-lucide="car" class="w-4 h-4 text-indigo-500"></i><span class="text-[10px] text-slate-400 font-bold uppercase tracking-tighter">차량 정보</span></div>
                <div class="flex justify-between items-center"><p class="text-sm font-bold">${data.taxiModel}</p><p class="text-sm font-black text-indigo-600">${data.taxiNumber}</p></div>
            </div>
          </div>
          <div class="space-y-4">
            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest px-1">동승 파트너</h4>
            <div class="flex flex-col gap-3">
              ${data.partners.map((p, idx) => `
                <div class="flex items-center justify-between bg-white border border-slate-100 p-4 rounded-2xl">
                  <div class="flex items-center gap-3">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=${p.name}" class="w-10 h-10 rounded-full bg-slate-50 border border-slate-100">
                    <div><p class="text-sm font-bold text-slate-800">${p.name}</p><span class="text-[10px] font-bold text-indigo-500">점수 85점</span></div>
                  </div>
                  ${p.reviewed 
                    ? `<button onclick="viewMyReview(${id}, ${idx})" class="px-4 py-2 bg-slate-100 text-slate-500 rounded-xl text-[10px] font-bold hover:bg-indigo-50 hover:text-indigo-600 transition-all active:scale-95">리뷰 보기</button>`
                    : `<button onclick="location.href='userReview.html'" class="px-4 py-2 bg-indigo-50 text-indigo-600 rounded-xl text-[10px] font-bold hover:bg-indigo-600 hover:text-white transition-all active:scale-95">리뷰쓰기</button>`
                  }
                </div>
              `).join('')}
            </div>
          </div>
          <div class="pt-2 border-t border-slate-100 flex justify-between items-end">
              <div><span class="text-[10px] font-bold text-indigo-50 uppercase mb-1 block">정산 금액</span><p class="font-bold">최종 본인 부담금</p></div>
              <span class="text-3xl font-black text-indigo-600 tracking-tight">${data.cost}</span>
          </div>
        `;
      document.getElementById('rideHistoryModal').classList.add('active');
      lucide.createIcons();
    }

    function closeRideDetail() {
      document.getElementById('rideHistoryModal').classList.remove('active');
    }

    // 내가 쓴 리뷰 보기 함수
    function viewMyReview(historyId, partnerIdx) {
      const data = rideHistory[historyId].partners[partnerIdx];
      document.getElementById('reviewTargetName').innerText = `To. ${data.name}`;
      document.getElementById('myReviewText').innerText = `"${data.content}"`;
      
      const starsEl = document.getElementById('myReviewStars');
      starsEl.innerHTML = '';
      for(let i=0; i<5; i++) {
          const star = document.createElement('i');
          star.setAttribute('data-lucide', 'star');
          star.className = `w-3 h-3 ${i < data.stars ? 'fill-amber-400 text-amber-400' : 'text-slate-200'}`;
          starsEl.appendChild(star);
      }
      
      document.getElementById('viewReviewModal').classList.add('active');
      lucide.createIcons();
    }

    function closeReviewModal() {
      document.getElementById('viewReviewModal').classList.remove('active');
    }

    const uploadButton = document.getElementById('uploadButton');
    const imageInput = document.getElementById('imageInput');
    const profilePreview = document.getElementById('profilePreview');
    uploadButton.addEventListener('click', () => imageInput.click());
    imageInput.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => profilePreview.src = e.target.result;
        reader.readAsDataURL(file);
      }
    });
  </script>
</body>

</html>