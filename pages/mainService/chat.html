<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>íƒˆë˜ë§ë˜ - ì‹¤ì‹œê°„ ì±„íŒ…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="../../component/nav/nav.js"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap");

      :root {
        --tm-primary: #4f46e5;
        --tm-dark: #1e1b4b;
        --tm-danger: #f43f5e;
      }

      body {
        font-family: "Pretendard", sans-serif;
        background-color: #f8fafc;
      }

      .glass-panel {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 8px 32px rgba(30, 27, 75, 0.05);
      }

      .custom-scroll::-webkit-scrollbar {
        width: 4px;
      }

      .custom-scroll::-webkit-scrollbar-thumb {
        background: #e2e8f0;
        border-radius: 10px;
      }

      .nav-item.active {
        color: #4f46e5;
        background-color: #eef2ff;
      }

      .chat-bubble-me {
        background: var(--tm-primary);
        color: white;
        border-radius: 1.25rem 1.25rem 0.25rem 1.25rem;
      }

      .chat-bubble-other {
        background: white;
        color: #1e293b;
        border: 1px solid #f1f5f9;
        border-radius: 1.25rem 1.25rem 1.25rem 0.25rem;
      }

      /* í”ŒëŸ¬ìŠ¤ ë²„íŠ¼ ë©”ë‰´ ì• ë‹ˆë©”ì´ì…˜ */
      #plus-menu {
        transform: translateY(15px) scale(0.95);
        opacity: 0;
        pointer-events: none;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        transform-origin: bottom left;
      }

      #plus-menu.active {
        transform: translateY(0) scale(1);
        opacity: 1;
        pointer-events: auto;
      }

      /* --- ê³µí†µ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ --- */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(15, 23, 42, 0.6);
        backdrop-filter: blur(8px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        padding: 1rem;
      }

      .modal-overlay.active {
        opacity: 1;
        pointer-events: auto;
      }

      .modal-content {
        background: white;
        width: 100%;
        max-width: 580px;
        max-height: 85vh;
        border-radius: 2.5rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transform: scale(0.95) translateY(20px);
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      }

      .modal-overlay.active .modal-content {
        transform: scale(1) translateY(0);
      }

      /* í”„ë¡œí•„ìš© ìŠ¤íƒ€ì¼ */
      .manner-score-bar {
        height: 10px;
        border-radius: 99px;
        background: #e2e8f0;
        overflow: hidden;
        position: relative;
      }

      .manner-score-fill {
        width: 0%;
        height: 100%;
        background: linear-gradient(90deg, #3b82f6, #4f46e5, #ef4444);
        transition: width 1.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        border-radius: 99px;
      }

      .btn-blocked {
        background-color: var(--tm-danger) !important;
        color: white !important;
        border-color: var(--tm-danger) !important;
      }

      .profile-trigger {
        cursor: pointer;
        transition: transform 0.2s;
      }

      .profile-trigger:hover {
        transform: scale(1.05);
      }

      .stat-badge {
        background: #f8fafc;
        border: 1px solid #f1f5f9;
      }

      .review-item.hidden {
        display: none;
      }
    </style>
  </head>

  <body class="h-screen flex overflow-hidden p-4 gap-4">
    <div
      id="navbar-container"
      class="w-20 h-full shrink-0 rounded-[2.5rem]"
    ></div>

    <main class="flex-1 flex gap-6 overflow-hidden">
      <div
        class="flex-1 flex flex-col glass-panel rounded-[2.5rem] overflow-hidden relative"
      >
        <div
          class="p-6 border-b border-slate-50 flex items-center justify-between bg-white/50"
        >
          <div class="flex items-center gap-4">
            <div
              class="w-12 h-12 bg-emerald-50 rounded-2xl flex items-center justify-center text-emerald-600"
            >
              <i data-lucide="map-pin" class="w-6 h-6"></i>
            </div>
            <div>
              <h2 class="font-bold text-slate-900">ê°•ë‚¨ì—­ 2ë²ˆ ì¶œêµ¬ â†’ íŒêµì—­</h2>
              <p class="text-xs text-slate-400">
                í˜„ì¬ 3ëª… ì°¸ì—¬ ì¤‘ Â· 5ë¶„ í›„ ì¶œë°œ
              </p>
            </div>
          </div>
          <button
            class="p-2 hover:bg-rose-50 text-slate-400 hover:text-rose-500 rounded-xl transition-all"
          >
            <i data-lucide="log-out" class="w-5 h-5"></i>
          </button>
        </div>

        <div
          class="flex-1 overflow-y-auto p-6 space-y-6 custom-scroll"
          id="chat-messages"
        >
          <div class="flex justify-center">
            <span
              class="text-[10px] font-bold text-slate-300 bg-slate-100 px-3 py-1 rounded-full uppercase"
              >Today</span
            >
          </div>

          <div class="flex items-end gap-3">
            <div
              class="w-8 h-8 rounded-full bg-slate-200 overflow-hidden shrink-0 shadow-sm profile-trigger"
              onclick="handleProfileClick('Aiden')"
            >
              <img
                src="https://api.dicebear.com/7.x/avataaars/svg?seed=Aiden"
                alt="user"
              />
            </div>
            <div class="flex flex-col gap-1 max-w-[70%]">
              <span class="text-[10px] text-slate-400 ml-1">ì—ì´ë“ </span>
              <div
                class="chat-bubble-other p-3.5 text-sm leading-relaxed shadow-sm"
              >
                ì•ˆë…•í•˜ì„¸ìš”! ì§€ê¸ˆ 2ë²ˆ ì¶œêµ¬ ì•ì— ë…¸ë€ìƒ‰ ì¹´ì¹´ì˜¤ íƒì‹œ ì˜†ì— ì„œìˆì–´ìš”.
              </div>
            </div>
            <span class="text-[10px] text-slate-300 mb-1">18:21</span>
          </div>

          <div class="flex items-end gap-3 justify-end">
            <span class="text-[10px] text-slate-300 mb-1">18:22</span>
            <div class="flex flex-col gap-1 max-w-[70%] items-end">
              <div
                class="chat-bubble-me p-3.5 text-sm leading-relaxed shadow-lg shadow-indigo-100"
              >
                ë„¤, í™•ì¸í–ˆìŠµë‹ˆë‹¤! ì € ì§€ê¸ˆ ì—ìŠ¤ì»¬ë ˆì´í„° íƒ€ê³  ì˜¬ë¼ê°€ê³  ìˆì–´ìš”.
                1ë¶„ë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!
              </div>
            </div>
          </div>

          <div class="flex justify-center">
            <div
              class="bg-indigo-50/50 px-4 py-2 rounded-2xl border border-indigo-100/50"
            >
              <p class="text-[11px] text-indigo-400 font-medium">
                âœ¨ 'ì§€ìˆ˜'ë‹˜ì´ ê·¸ë£¹ì— ì°¸ì—¬í–ˆìŠµë‹ˆë‹¤.
              </p>
            </div>
          </div>

          <div class="flex items-end gap-3">
            <div
              class="w-8 h-8 rounded-full bg-slate-200 overflow-hidden shrink-0 shadow-sm profile-trigger"
              onclick="handleProfileClick('Ji-su')"
            >
              <img
                src="https://api.dicebear.com/7.x/avataaars/svg?seed=Ji-su"
                alt="user"
              />
            </div>
            <div class="flex flex-col gap-1 max-w-[70%]">
              <span class="text-[10px] text-slate-400 ml-1">ì§€ìˆ˜</span>
              <div
                class="chat-bubble-other p-3.5 text-sm leading-relaxed shadow-sm"
              >
                ì•ˆë…•í•˜ì„¸ìš”~ ì €ë„ ì§€ê¸ˆ ê±°ì˜ ë‹¤ ì™”ì–´ìš”!
              </div>
            </div>
            <span class="text-[10px] text-slate-300 mb-1">18:24</span>
          </div>
        </div>

        <div
          id="plus-menu"
          class="absolute bottom-24 left-6 w-72 glass-panel rounded-[2rem] p-5 z-30 grid grid-cols-4 gap-4"
        >
          <button
            class="menu-item flex flex-col items-center gap-2 group"
            title="ì‚¬ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬"
          >
            <div
              class="w-12 h-12 bg-blue-50 text-blue-500 rounded-2xl flex items-center justify-center group-hover:bg-blue-500 group-hover:text-white transition-all shadow-sm"
            >
              <i data-lucide="image" class="w-6 h-6"></i>
            </div>
            <span class="text-[10px] font-bold text-slate-500">ì‚¬ì§„</span>
          </button>
          <button
            class="menu-item flex flex-col items-center gap-2 group"
            title="ì¹´ë©”ë¼ ì´¬ì˜"
          >
            <div
              class="w-12 h-12 bg-orange-50 text-orange-500 rounded-2xl flex items-center justify-center group-hover:bg-orange-500 group-hover:text-white transition-all shadow-sm"
            >
              <i data-lucide="camera" class="w-6 h-6"></i>
            </div>
            <span class="text-[10px] font-bold text-slate-500">ì¹´ë©”ë¼</span>
          </button>
          <button
            class="menu-item flex flex-col items-center gap-2 group"
            title="í˜„ì¬ ìœ„ì¹˜ ê³µìœ "
          >
            <div
              class="w-12 h-12 bg-emerald-50 text-emerald-500 rounded-2xl flex items-center justify-center group-hover:bg-emerald-500 group-hover:text-white transition-all shadow-sm"
            >
              <i data-lucide="map-pin" class="w-6 h-6"></i>
            </div>
            <span class="text-[10px] font-bold text-slate-500">ìœ„ì¹˜</span>
          </button>
          <button
            class="menu-item flex flex-col items-center gap-2 group"
            title="ì´ëª¨ì§€"
          >
            <div
              class="w-12 h-12 bg-amber-50 text-amber-500 rounded-2xl flex items-center justify-center group-hover:bg-amber-500 group-hover:text-white transition-all shadow-sm"
            >
              <i data-lucide="smile" class="w-6 h-6"></i>
            </div>
            <span class="text-[10px] font-bold text-slate-500">ì´ëª¨ì§€</span>
          </button>
        </div>

        <div class="p-6 bg-white border-t border-slate-50">
          <div
            class="flex items-center gap-3 bg-slate-50 p-2 rounded-[1.5rem] border border-transparent focus-within:border-indigo-100 focus-within:bg-white transition-all"
          >
            <button
              id="plus-btn"
              class="p-2 text-slate-400 hover:text-indigo-600 transition-all focus:outline-none"
            >
              <i data-lucide="plus-circle" class="w-6 h-6"></i>
            </button>
            <input
              type="text"
              id="chat-input"
              placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
              class="flex-1 bg-transparent border-none outline-none text-sm text-slate-700 py-2"
            />
            <button class="bg-indigo-600 text-white p-2.5 rounded-xl shadow-md">
              <i data-lucide="send" class="w-4 h-4"></i>
            </button>
          </div>
        </div>
      </div>

      <aside class="w-80 flex flex-col gap-6 h-full overflow-hidden">
        <div
          onclick="openRideDetail()"
          class="glass-panel p-6 rounded-[2.5rem] shrink-0 cursor-pointer hover:border-indigo-200 hover:shadow-md transition-all group relative"
        >
          <div
            class="absolute right-6 top-6 opacity-0 group-hover:opacity-100 transition-opacity"
          >
            <i data-lucide="info" class="w-5 h-5 text-indigo-400"></i>
          </div>
          <h3
            class="font-bold text-slate-900 mb-4 text-sm group-hover:text-indigo-600 transition-colors"
          >
            ì—¬ì • ì •ë³´
          </h3>
          <div class="space-y-4">
            <div class="flex items-start gap-3">
              <div
                class="w-1.5 h-1.5 rounded-full bg-emerald-500 mt-1.5 shadow-[0_0_8px_rgba(16,185,129,0.5)]"
              ></div>
              <div>
                <p class="text-[10px] font-bold text-slate-400 uppercase">
                  Start
                </p>
                <p class="text-xs font-bold text-slate-700">
                  ê°•ë‚¨ì—­ 2ë²ˆ ì¶œêµ¬ ì•
                </p>
              </div>
            </div>
            <div
              class="ml-0.5 border-l-2 border-dashed border-slate-100 h-6"
            ></div>
            <div class="flex items-start gap-3">
              <div
                class="w-1.5 h-1.5 rounded-full bg-rose-500 mt-1.5 shadow-[0_0_8px_rgba(244,63,94,0.5)]"
              ></div>
              <div>
                <p class="text-[10px] font-bold text-slate-400 uppercase">
                  Destination
                </p>
                <p class="text-xs font-bold text-slate-700">
                  íŒêµì—­ ì§€í•˜ì²  ì…êµ¬
                </p>
              </div>
            </div>
          </div>
        </div>

        <div
          class="glass-panel p-6 rounded-[2.5rem] flex-1 overflow-y-auto custom-scroll"
        >
          <h3 class="font-bold text-slate-900 mb-4 text-sm">
            ì°¸ì—¬ ë©¤ë²„ <span class="text-indigo-600">(3/4)</span>
          </h3>
          <div class="space-y-4">
            <div class="flex items-center gap-3">
              <div
                class="w-10 h-10 rounded-full bg-slate-200 overflow-hidden shadow-sm border-2 border-indigo-600"
              >
                <img
                  src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix"
                  alt="user"
                />
              </div>
              <div>
                <p
                  class="text-sm font-bold text-slate-900 flex items-center gap-1"
                >
                  íŒêµë™ìŠ¹ì™•
                  <span
                    class="text-[10px] bg-indigo-100 text-indigo-600 px-1.5 py-0.5 rounded-md"
                    >ë‚˜</span
                  >
                </p>
                <p class="text-xs text-slate-400">ë§¤ë„ˆì ìˆ˜ 42ì </p>
              </div>
            </div>
            <div
              class="flex items-center gap-3 profile-trigger"
              onclick="handleProfileClick('Aiden')"
            >
              <div
                class="w-10 h-10 rounded-full bg-slate-200 overflow-hidden shadow-sm"
              >
                <img
                  src="https://api.dicebear.com/7.x/avataaars/svg?seed=Aiden"
                  alt="user"
                />
              </div>
              <div>
                <p class="text-sm font-bold text-slate-900">ì—ì´ë“ </p>
                <p class="text-xs text-indigo-500 font-medium italic">
                  í”„ë¡œí•„ ë³´ê¸°
                </p>
              </div>
            </div>
            <div
              class="flex items-center gap-3 profile-trigger"
              onclick="handleProfileClick('Ji-su')"
            >
              <div
                class="w-10 h-10 rounded-full bg-slate-200 overflow-hidden shadow-sm"
              >
                <img
                  src="https://api.dicebear.com/7.x/avataaars/svg?seed=Ji-su"
                  alt="user"
                />
              </div>
              <div>
                <p class="text-sm font-bold text-slate-900">ì§€ìˆ˜</p>
                <p class="text-xs text-indigo-500 font-medium italic">
                  í”„ë¡œí•„ ë³´ê¸°
                </p>
              </div>
            </div>
          </div>
        </div>
      </aside>
    </main>

    <div id="profile-modal" class="modal-overlay" onclick="closeProfile()">
      <div
        class="modal-content flex flex-col"
        onclick="event.stopPropagation()"
      >
        <div
          class="p-6 border-b border-slate-50 flex justify-between items-center bg-white sticky top-0 z-10"
        >
          <h3 class="font-bold text-slate-900">í”„ë¡œí•„ ì •ë³´</h3>
          <div class="flex items-center gap-2">
            <button
              id="modal-block-btn"
              class="p-2.5 bg-slate-50 border border-slate-100 text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-xl transition-all"
            >
              <i data-lucide="ban" class="w-5 h-5"></i>
            </button>
            <button
              onclick="closeProfile()"
              class="p-2.5 hover:bg-slate-100 rounded-xl text-slate-400"
            >
              <i data-lucide="x" class="w-5 h-5"></i>
            </button>
          </div>
        </div>

        <div
          class="flex-1 overflow-y-auto custom-scroll p-8 space-y-8"
          id="modal-body"
        >
          <div class="flex flex-col items-center text-center">
            <div
              class="w-24 h-24 rounded-[2.2rem] bg-indigo-50 border-4 border-white shadow-xl overflow-hidden mb-5"
            >
              <img
                id="modal-profile-img"
                src=""
                alt="profile"
                class="w-full h-full object-cover"
              />
            </div>
            <div class="space-y-1">
              <div class="flex items-center justify-center gap-2">
                <h2
                  id="modal-profile-name"
                  class="text-2xl font-black text-slate-900 tracking-tight"
                >
                  ì‚¬ìš©ì
                </h2>
                <span
                  id="modal-profile-lv"
                  class="bg-indigo-600 text-white text-[10px] px-2 py-0.5 rounded-lg font-bold"
                  >LV. 1</span
                >
              </div>
              <p
                id="modal-profile-meta"
                class="text-xs text-slate-400 font-medium"
              >
                ê°€ì… ì •ë³´ ë¡œë”© ì¤‘...
              </p>
            </div>
            <div
              id="modal-profile-bio"
              class="mt-6 w-full max-w-xs p-4 bg-slate-50/80 rounded-2xl text-xs text-slate-600 leading-relaxed font-medium"
            >
              ì†Œê°œê¸€
            </div>
          </div>

          <div class="space-y-4">
            <div class="flex justify-between items-end px-1">
              <div class="flex items-center gap-1">
                <span
                  id="modal-score-text"
                  class="text-3xl font-black text-indigo-600 italic"
                  >0</span
                ><span class="text-sm font-bold text-slate-300">ì </span>
              </div>
              <span
                id="modal-score-rank"
                class="text-xs font-bold text-indigo-500 bg-indigo-50 px-2 py-1 rounded-lg"
                >ìƒìœ„ 0%</span
              >
            </div>
            <div class="manner-score-bar">
              <div id="modal-score-fill" class="manner-score-fill"></div>
            </div>
          </div>

          <div class="space-y-4">
            <h4
              class="text-sm font-bold text-slate-900 flex items-center gap-2"
            >
              <i data-lucide="bar-chart-3" class="w-4 h-4 text-indigo-600"></i
              >ì£¼ìš” íŠ¹ì§•
            </h4>
            <div class="grid grid-cols-2 gap-3">
              <div
                class="stat-badge p-3 rounded-2xl flex justify-between items-center"
              >
                <span class="text-xs font-bold text-slate-600"
                  >â° ì‹œê°„ ì•½ì†</span
                >
                <span
                  id="modal-stat-time"
                  class="text-xs font-black text-indigo-600"
                  >0íšŒ</span
                >
              </div>
              <div
                class="stat-badge p-3 rounded-2xl flex justify-between items-center"
              >
                <span class="text-xs font-bold text-slate-600"
                  >ğŸ¤« ì •ìˆ™í•œ ì´ë™</span
                >
                <span
                  id="modal-stat-silent"
                  class="text-xs font-black text-indigo-600"
                  >0íšŒ</span
                >
              </div>
            </div>
          </div>

          <div class="space-y-4">
            <div class="flex justify-between items-center">
              <h4
                class="text-sm font-bold text-slate-900 flex items-center gap-2"
              >
                <i
                  data-lucide="message-square"
                  class="w-4 h-4 text-indigo-600"
                ></i
                >ë™ìŠ¹ì í›„ê¸°
              </h4>
              <button
                id="modal-view-all-reviews"
                class="text-[10px] font-bold text-indigo-600 underline cursor-pointer hidden"
              >
                ì „ì²´ë³´ê¸°
              </button>
            </div>
            <div class="space-y-3" id="modal-review-list"></div>
          </div>
        </div>

        <div class="p-6 bg-white border-t border-slate-50">
          <button
            onclick="closeProfile()"
            class="w-full py-4 bg-slate-900 text-white rounded-2xl font-bold text-sm shadow-xl active:scale-95 transition-all"
          >
            í™•ì¸
          </button>
        </div>
      </div>
    </div>

    <div
      id="ride-detail-modal"
      class="modal-overlay"
      onclick="closeRideDetail()"
    >
      <div
        class="modal-content flex flex-col"
        onclick="event.stopPropagation()"
      >
        <div
          class="p-6 border-b border-slate-100 flex items-center justify-between bg-white/90 sticky top-0 z-10"
        >
          <h3 class="text-lg font-bold text-slate-900">íƒ‘ìŠ¹ ìƒì„¸ ì •ë³´</h3>
          <button
            onclick="closeRideDetail()"
            class="p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-500"
          >
            <i data-lucide="x" class="w-5 h-5"></i>
          </button>
        </div>

        <div
          class="overflow-y-auto custom-scroll p-6 space-y-6 bg-slate-50/50 flex-1"
        >
          <div
            class="bg-white p-5 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-4"
          >
            <div
              class="w-16 h-16 rounded-2xl bg-slate-100 overflow-hidden shrink-0 border border-slate-200"
            >
              <img
                src="https://api.dicebear.com/7.x/avataaars/svg?seed=Driver"
                alt="driver"
                class="w-full h-full object-cover"
              />
            </div>
            <div class="flex-1">
              <div class="flex justify-between items-start">
                <div>
                  <span
                    class="text-[10px] font-bold text-white bg-slate-800 px-2 py-0.5 rounded-full"
                    >ê°œì¸íƒì‹œ</span
                  >
                  <h4 class="text-lg font-bold text-slate-900 mt-1">
                    ê¹€ìš´ì „ ê¸°ì‚¬ë‹˜
                  </h4>
                </div>
                <div class="text-right">
                  <p class="text-sm font-bold text-slate-600">ì†Œë‚˜íƒ€ (ì‹ í˜•)</p>
                  <p class="text-lg font-black text-indigo-600">34ë°” 1234</p>
                </div>
              </div>
            </div>
          </div>

          <div
            class="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm"
          >
            <h4
              class="text-sm font-bold text-slate-400 mb-4 uppercase tracking-wider"
            >
              ì´ë™ ê²½ë¡œ
            </h4>
            <div class="relative pl-2 space-y-8">
              <div
                class="absolute left-[11px] top-2 bottom-2 w-0.5 bg-slate-100"
              ></div>

              <div class="relative flex gap-4">
                <div
                  class="w-5 h-5 rounded-full bg-white border-4 border-emerald-500 z-10 shrink-0"
                ></div>
                <div>
                  <p class="text-xs font-bold text-slate-400">
                    18:30 ì¶œë°œ ì˜ˆì •
                  </p>
                  <p class="text-sm font-bold text-slate-900">
                    ê°•ë‚¨ì—­ 2ë²ˆ ì¶œêµ¬
                  </p>
                </div>
              </div>

              <div class="relative flex gap-4">
                <div
                  class="w-5 h-5 rounded-full bg-indigo-600 z-10 shrink-0 flex items-center justify-center shadow-lg shadow-indigo-300"
                >
                  <i data-lucide="car" class="w-3 h-3 text-white"></i>
                </div>
                <div>
                  <p class="text-xs font-bold text-indigo-600 animate-pulse">
                    í˜„ì¬ ì´ë™ ì¤‘
                  </p>
                  <p class="text-sm font-bold text-slate-900">
                    ë±…ë±…ì‚¬ê±°ë¦¬ ë¶€ê·¼
                  </p>
                </div>
              </div>

              <div class="relative flex gap-4">
                <div
                  class="w-5 h-5 rounded-full bg-white border-4 border-rose-500 z-10 shrink-0"
                ></div>
                <div>
                  <p class="text-xs font-bold text-slate-400">
                    19:05 ë„ì°© ì˜ˆì •
                  </p>
                  <p class="text-sm font-bold text-slate-900">
                    íŒêµì—­ ì§€í•˜ì²  ì…êµ¬
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="bg-indigo-50/50 p-6 rounded-3xl border border-indigo-100">
            <div class="flex justify-between items-center mb-4">
              <h4 class="text-sm font-bold text-indigo-900">ì˜ˆìƒ ê²°ì œ ê¸ˆì•¡</h4>
              <span
                class="text-xs bg-white border border-indigo-100 text-indigo-600 px-2 py-1 rounded-lg font-bold"
                >ì„ ê²°ì œ ì™„ë£Œ</span
              >
            </div>
            <div
              class="flex justify-between items-end border-b border-indigo-100/50 pb-4 mb-4"
            >
              <span class="text-slate-500 text-sm">ì´ íƒì‹œ ìš”ê¸ˆ (ì˜ˆìƒ)</span>
              <span class="text-slate-900 font-bold">18,000ì›</span>
            </div>
            <div class="flex justify-between items-end">
              <span class="text-slate-500 text-sm">ë‚˜ì˜ ë¶€ë‹´ê¸ˆ (1/4)</span>
              <span class="text-2xl font-black text-indigo-600">4,500ì›</span>
            </div>
          </div>
        </div>

        <div class="p-6 bg-white border-t border-slate-100">
          <button
            onclick="closeRideDetail()"
            class="w-full bg-slate-900 hover:bg-indigo-600 text-white font-bold py-4 rounded-2xl transition-all shadow-lg"
          >
            í™•ì¸
          </button>
        </div>
      </div>
    </div>

    <script>
      // ë„¤ë¹„ê²Œì´ì…˜ ë° ì•„ì´ì½˜ ì´ˆê¸°í™”
      if (typeof loadNavbar === "function") loadNavbar("nav-chat");
      lucide.createIcons();

      // í”ŒëŸ¬ìŠ¤ ë©”ë‰´ ë¡œì§
      const plusBtn = document.getElementById("plus-btn");
      const plusMenu = document.getElementById("plus-menu");
      plusBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        const isActive = plusMenu.classList.toggle("active");
        plusBtn.style.transform = isActive ? "rotate(45deg)" : "rotate(0deg)";
        plusBtn.classList.toggle("text-indigo-600", isActive);
      });

      document.addEventListener("click", (e) => {
        if (!plusMenu.contains(e.target) && !plusBtn.contains(e.target)) {
          plusMenu.classList.remove("active");
          plusBtn.style.transform = "rotate(0deg)";
          plusBtn.classList.remove("text-indigo-600");
        }
      });

      // --- í”„ë¡œí•„ íŒì—… ë°ì´í„° ë° ë¡œì§ ---
      const modal = document.getElementById("profile-modal");
      const scoreFill = document.getElementById("modal-score-fill");
      const reviewContainer = document.getElementById("modal-review-list");
      const viewAllBtn = document.getElementById("modal-view-all-reviews");
      let reviewsExpanded = false;

      // ìœ ì € ë°ì´í„° (í´ë¦­ ì‹œ ë™ì  ë°˜ì˜ìš©)
      const usersData = {
        "Ji-su": {
          name: "ì§€ìˆ˜",
          lv: "LV. 8",
          img: "https://api.dicebear.com/7.x/avataaars/svg?seed=Ji-su",
          meta: "ê°€ì… 124ì¼ì§¸ Â· ë™ìŠ¹ 48íšŒ",
          bio: '"ì£¼ë¡œ í‰ì¼ ì•„ì¹¨ ì¶œê·¼ ì‹œê°„ì— íŒêµì—­ ê·¼ì²˜ì—ì„œ í™œë™í•´ìš”! ğŸ˜Š"',
          score: 88,
          rank: "ìƒìœ„ 5%",
          stats: { time: 24, silent: 18 },
          reviews: [
            {
              author: "ì—ì´ë“ ",
              date: "3ì¼ ì „",
              content: "ì •ë§ ì¹œì ˆí•˜ì‹œê³  ì‹œê°„ë„ ë”± ë§ì¶°ì„œ ì™€ì£¼ì…¨ì–´ìš”!",
            },
            {
              author: "íŒêµë™ìŠ¹ì™•",
              date: "1ì£¼ì¼ ì „",
              content: "ë§¤ë„ˆê°€ ì •ë§ ì¢‹ìœ¼ì„¸ìš”. ì •ì‚°ë„ ë°”ë¡œ í•´ì£¼ì…¨ìŠµë‹ˆë‹¤.",
            },
            {
              author: "ì‚¬ë¼",
              date: "2ì£¼ì¼ ì „",
              content: "ì¡°ìš©íˆ ê°€ê³  ì‹¶ì—ˆëŠ”ë° ë°°ë ¤í•´ì£¼ì…”ì„œ ë„ˆë¬´ ê°ì‚¬í–ˆì–´ìš”.",
            },
            {
              author: "ë¯¼ìˆ˜",
              date: "í•œë‹¬ ì „",
              content: "ì°¨ëŸ‰ ë‚´ë¶€ë„ ì¾Œì í•˜ê³  ë§¤ë„ˆê°€ í›Œë¥­í•˜ì‹­ë‹ˆë‹¤.",
            },
          ],
        },
        Aiden: {
          name: "ì—ì´ë“ ",
          lv: "LV. 5",
          img: "https://api.dicebear.com/7.x/avataaars/svg?seed=Aiden",
          meta: "ê°€ì… 42ì¼ì§¸ Â· ë™ìŠ¹ 12íšŒ",
          bio: '"ë§¤ë„ˆ ìˆëŠ” ë™ìŠ¹ì„ ì¶”êµ¬í•©ë‹ˆë‹¤. ì¡°ìš©íˆ ê°€ëŠ” ê±¸ ì„ í˜¸í•´ìš”!"',
          score: 72,
          rank: "ìƒìœ„ 15%",
          stats: { time: 8, silent: 10 },
          reviews: [
            {
              author: "ì§€ìˆ˜",
              date: "1ì¼ ì „",
              content: "ëŒ€í™”ê°€ ì •ë§ ì¦ê±°ì› ìŠµë‹ˆë‹¤! ì¢‹ì€ ë¶„ì´ì—ìš”.",
            },
            {
              author: "ì² ìˆ˜",
              date: "5ì¼ ì „",
              content: "ë§¤ë„ˆê°€ ì¢‹ìœ¼ì‹  ìŠ¹ê°ë¶„ì…ë‹ˆë‹¤.",
            },
          ],
        },
      };

      /** í”„ë¡œí•„ íŒì—… íŠ¸ë¦¬ê±° */
      function handleProfileClick(userId) {
        const data = usersData[userId];
        if (!data) return;

        document.getElementById("modal-profile-img").src = data.img;
        document.getElementById("modal-profile-name").innerText = data.name;
        document.getElementById("modal-profile-lv").innerText = data.lv;
        document.getElementById("modal-profile-meta").innerText = data.meta;
        document.getElementById("modal-profile-bio").innerText = data.bio;
        document.getElementById("modal-score-text").innerText = data.score;
        document.getElementById("modal-score-rank").innerText = data.rank;
        document.getElementById(
          "modal-stat-time"
        ).innerText = `${data.stats.time}íšŒ`;
        document.getElementById(
          "modal-stat-silent"
        ).innerText = `${data.stats.silent}íšŒ`;

        renderReviews(data.reviews);

        modal.classList.add("active");
        document.body.style.overflow = "hidden";
        setTimeout(() => {
          scoreFill.style.width = `${data.score}%`;
        }, 400);
      }

      function renderReviews(reviews) {
        reviewContainer.innerHTML = "";
        reviewsExpanded = false;
        viewAllBtn.innerText = "ì „ì²´ë³´ê¸°";
        viewAllBtn.classList.toggle("hidden", reviews.length <= 3);

        reviews.forEach((r, i) => {
          const div = document.createElement("div");
          div.className = `review-item p-4 bg-slate-50 rounded-2xl border border-slate-100 space-y-2 ${
            i >= 3 ? "hidden" : ""
          }`;
          div.innerHTML = `
            <div class="flex justify-between items-center">
              <span class="text-[10px] font-bold text-slate-700">${r.author}</span>
              <span class="text-[9px] text-slate-300">${r.date}</span>
            </div>
            <p class="text-xs text-slate-600 leading-relaxed">${r.content}</p>
          `;
          reviewContainer.appendChild(div);
        });
      }

      viewAllBtn.addEventListener("click", () => {
        const items = reviewContainer.querySelectorAll(".review-item");
        reviewsExpanded = !reviewsExpanded;
        items.forEach((item, i) => {
          if (i >= 3) item.classList.toggle("hidden", !reviewsExpanded);
        });
        viewAllBtn.innerText = reviewsExpanded ? "ì ‘ê¸°" : "ì „ì²´ë³´ê¸°";
      });

      function closeProfile() {
        scoreFill.style.width = "0%";
        modal.classList.remove("active");
        document.body.style.overflow = "";
      }

      const modalBlockBtn = document.getElementById("modal-block-btn");
      let isBlocked = false;
      modalBlockBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        isBlocked = !isBlocked;
        modalBlockBtn.classList.toggle("btn-blocked", isBlocked);
        const icon = modalBlockBtn.querySelector("i");
        icon.setAttribute("data-lucide", isBlocked ? "user-check" : "ban");
        lucide.createIcons();
      });

      // --- [NEW] ìƒì„¸ ì •ë³´ ëª¨ë‹¬ ì œì–´ í•¨ìˆ˜ ---
      function openRideDetail() {
        document.getElementById("ride-detail-modal").classList.add("active");
      }

      function closeRideDetail() {
        document.getElementById("ride-detail-modal").classList.remove("active");
      }
    </script>
  </body>
</html>
