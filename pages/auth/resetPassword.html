<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>탈래말래 - 비밀번호 재설정</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap");

      :root {
        --tm-primary: #4f46e5;
        --tm-error: #ef4444;
        --tm-dark: #1e1b4b;
      }

      body {
        font-family: "Pretendard", sans-serif;
        background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .card-container {
        background: white;
        border-radius: 24px;
        box-shadow: 0 10px 40px rgba(30, 27, 75, 0.1);
        width: 100%;
        max-width: 420px;
        overflow: hidden;
      }

      .input-focus:focus-within {
        border-color: var(--tm-primary);
        box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
      }

      /* 에러 스타일 */
      .input-error {
        border-color: var(--tm-error) !important;
        background-color: #fef2f2;
        animation: shake 0.3s ease-in-out;
      }

      .error-msg {
        color: var(--tm-error);
        font-size: 11px;
        margin-top: 4px;
        margin-left: 4px;
        display: none;
        font-weight: 600;
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-2px);
        }
        75% {
          transform: translateX(2px);
        }
      }
    </style>
  </head>

  <body class="text-slate-800">
    <div class="card-container">
      <div class="px-8 pt-10 pb-6 flex flex-col">
        <div
          class="w-12 h-12 bg-indigo-50 rounded-2xl flex items-center justify-center text-indigo-600 mb-4"
        >
          <i data-lucide="lock-keyhole" class="w-6 h-6"></i>
        </div>
        <h2 class="text-2xl font-bold text-slate-900">비밀번호 재설정</h2>
        <p class="text-slate-500 mt-2 text-sm leading-relaxed">
          새로운 비밀번호를 설정해주세요.<br />
          이전에 사용한 적 없는 비밀번호가 안전합니다.
        </p>
      </div>

      <form
        class="px-8 pb-10 space-y-5"
        onsubmit="event.preventDefault(); handleReset();"
      >
        <div class="space-y-1.5">
          <label class="text-xs font-bold text-slate-500 ml-1"
            >새 비밀번호</label
          >
          <div
            class="relative flex items-center bg-slate-50 border border-slate-200 rounded-xl transition-all input-focus"
          >
            <i
              data-lucide="lock"
              class="absolute left-4 w-5 h-5 text-slate-400"
            ></i>
            <input
              id="newPassword"
              type="password"
              placeholder="8자 이상 입력해주세요"
              class="w-full pl-12 pr-4 py-4 bg-transparent rounded-xl focus:outline-none text-sm"
              oninput="validateForm()"
            />
          </div>
          <p class="error-msg" id="pw-len-error">
            비밀번호는 8자 이상이어야 합니다.
          </p>
        </div>

        <div class="space-y-1.5">
          <label class="text-xs font-bold text-slate-500 ml-1"
            >비밀번호 확인</label
          >
          <div
            class="relative flex items-center bg-slate-50 border border-slate-200 rounded-xl transition-all input-focus"
            id="confirmWrapper"
          >
            <i
              data-lucide="check-circle-2"
              class="absolute left-4 w-5 h-5 text-slate-400"
            ></i>
            <input
              id="confirmPassword"
              type="password"
              placeholder="한 번 더 입력해주세요"
              class="w-full pl-12 pr-4 py-4 bg-transparent rounded-xl focus:outline-none text-sm"
              oninput="validateForm()"
            />
          </div>
          <p class="error-msg" id="pw-match-error">
            비밀번호가 일치하지 않습니다.
          </p>
        </div>

        <button
          type="submit"
          class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-100 transition-all active:scale-[0.98] mt-2"
        >
          비밀번호 변경하기
        </button>
      </form>
    </div>

    <div
      id="successModal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-[2px] p-4 transition-all"
    >
      <div
        class="bg-white rounded-[2rem] p-8 w-full max-w-sm text-center shadow-2xl transform scale-100 transition-all"
      >
        <div
          class="w-16 h-16 bg-emerald-50 rounded-full flex items-center justify-center mx-auto mb-6 text-emerald-500"
        >
          <i data-lucide="shield-check" class="w-8 h-8"></i>
        </div>

        <h3 class="text-xl font-bold text-slate-900 mb-2">변경 완료!</h3>
        <p class="text-sm text-slate-500 leading-relaxed mb-8">
          비밀번호가 성공적으로 변경되었습니다.<br />
          새 비밀번호로 로그인해주세요.
        </p>

        <button
          onclick="location.href='./login.html'"
          class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl transition-all active:scale-[0.98]"
        >
          로그인하러 가기
        </button>
      </div>
    </div>

    <script>
      lucide.createIcons();

      function validateForm() {
        const pw = document.getElementById("newPassword").value;
        const confirmPw = document.getElementById("confirmPassword").value;

        const confirmWrapper = document.getElementById("confirmWrapper");
        const matchError = document.getElementById("pw-match-error");

        let isValid = true;

        // 1. 일치 여부 실시간 검사
        if (confirmPw.length > 0) {
          if (pw !== confirmPw) {
            confirmWrapper.classList.add("input-error");
            matchError.style.display = "block";
            isValid = false;
          } else {
            confirmWrapper.classList.remove("input-error");
            matchError.style.display = "none";
          }
        } else {
          confirmWrapper.classList.remove("input-error");
          matchError.style.display = "none";
        }

        return isValid;
      }

      function handleReset() {
        const pwInput = document.getElementById("newPassword");
        const confirmInput = document.getElementById("confirmPassword");

        const pw = pwInput.value;
        const confirmPw = confirmInput.value;

        // 1. 길이 검사
        if (pw.length < 8) {
          document.getElementById("pw-len-error").style.display = "block";
          pwInput.parentElement.classList.add("input-error");
          return;
        } else {
          document.getElementById("pw-len-error").style.display = "none";
          pwInput.parentElement.classList.remove("input-error");
        }

        // 2. 일치 검사
        if (pw !== confirmPw) {
          document.getElementById("pw-match-error").style.display = "block";
          document
            .getElementById("confirmWrapper")
            .classList.add("input-error");
          return;
        }

        // 성공 시 모달 띄우기
        document.getElementById("successModal").classList.remove("hidden");
      }
    </script>
  </body>
</html>
