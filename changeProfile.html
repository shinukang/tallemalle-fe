<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>íƒˆë˜ë§ë˜ - íšŒì› ì •ë³´ ìˆ˜ì •</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="nav.js"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap");

      :root {
        --tm-primary: #4f46e5;
        --tm-error: #ef4444;
      }

      body {
        font-family: "Pretendard", sans-serif;
        background-color: #f8fafc;
      }

      .glass-panel {
        background: rgba(255, 255, 255, 0.92);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 8px 32px rgba(30, 27, 75, 0.05);
      }

      .custom-scroll::-webkit-scrollbar {
        width: 5px;
      }

      .custom-scroll::-webkit-scrollbar-thumb {
        background: #e2e8f0;
        border-radius: 10px;
      }

      .input-focus {
        transition: all 0.2s ease;
      }

      .input-focus:focus {
        border-color: #4f46e5;
        box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
        outline: none;
      }

      /* ì½ê¸° ì „ìš© í•„ë“œ ìŠ¤íƒ€ì¼ */
      .input-readonly {
        background-color: #f1f5f9;
        color: #94a3b8;
        cursor: not-allowed;
        border-color: #e2e8f0;
      }

      .tag-checkbox:checked + label {
        background-color: #eef2ff;
        border-color: #4f46e5;
        color: #4f46e5;
      }

      /* --- ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ê³µí†µ --- */
      .modal-overlay {
        background-color: rgba(30, 27, 75, 0.6);
        backdrop-filter: blur(4px);
      }
      .modal-content {
        animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      }
      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
    </style>
  </head>

  <body class="overflow-hidden">
    <div class="flex h-screen p-4 gap-4">
      <div
        id="navbar-container"
        class="w-20 h-full shrink-0 rounded-[2.5rem]"
      ></div>

      <div
        class="flex-1 glass-panel rounded-[2.5rem] overflow-hidden flex flex-col relative"
      >
        <div
          class="p-8 border-b border-slate-100 flex justify-between items-center"
        >
          <div class="flex items-center gap-4">
            <button
              onclick="history.back()"
              class="p-2 hover:bg-slate-100 rounded-xl transition-all text-slate-400"
            >
              <i data-lucide="arrow-left" class="w-6 h-6"></i>
            </button>
            <div>
              <h1 class="text-2xl font-extrabold text-slate-900 tracking-tight">
                íšŒì› ì •ë³´ ìˆ˜ì •
              </h1>
              <p class="text-sm text-slate-400 font-medium mt-1">
                í”„ë¡œí•„ ì •ë³´ë¥¼ ë³€ê²½í•˜ê³  ì €ì¥í•˜ì„¸ìš”.
              </p>
            </div>
          </div>
          <div class="flex gap-3">
            <button
              onclick="history.back()"
              class="px-6 py-2.5 text-sm font-bold text-slate-400 hover:text-slate-600 transition-all"
            >
              ì·¨ì†Œ
            </button>
            <button
              onclick="handleSave()"
              class="px-8 py-2.5 bg-indigo-600 text-white rounded-2xl font-bold text-sm shadow-lg shadow-indigo-100 hover:bg-indigo-700 transition-all active:scale-95"
            >
              ë³€ê²½ì‚¬í•­ ì €ì¥
            </button>
          </div>
        </div>

        <div class="flex-1 overflow-y-auto custom-scroll p-8">
          <div class="max-w-2xl mx-auto space-y-10">
            <div class="flex flex-col items-center">
              <div class="relative group cursor-pointer">
                <div
                  class="w-32 h-32 rounded-[2.5rem] overflow-hidden border-4 border-white shadow-xl bg-slate-100 transition-transform group-hover:scale-[1.02]"
                >
                  <img
                    id="profile-preview"
                    src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix"
                    alt="profile"
                    class="w-full h-full object-cover"
                  />
                </div>
                <label
                  for="avatar-upload"
                  class="absolute -bottom-2 -right-2 p-3 bg-indigo-600 text-white rounded-2xl shadow-xl border-4 border-white cursor-pointer hover:bg-indigo-700 transition-all"
                >
                  <i data-lucide="camera" class="w-5 h-5"></i>
                  <input
                    type="file"
                    id="avatar-upload"
                    class="hidden"
                    accept="image/*"
                  />
                </label>
              </div>
              <p
                class="mt-4 text-[11px] font-bold text-slate-400 uppercase tracking-wider"
              >
                í´ë¦­í•˜ì—¬ ì‚¬ì§„ ë³€ê²½
              </p>
            </div>

            <div class="space-y-6">
              <h3
                class="text-lg font-bold text-slate-900 flex items-center gap-2"
              >
                <span class="w-1.5 h-6 bg-indigo-600 rounded-full"></span>
                ê¸°ë³¸ ì •ë³´
              </h3>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="col-span-1 md:col-span-2">
                  <label
                    class="block text-xs font-bold text-slate-400 mb-2 ml-1"
                    >ë‹‰ë„¤ì„ <span class="text-indigo-600">*</span></label
                  >
                  <input
                    type="text"
                    value="íŒêµë™ìŠ¹ì™•"
                    class="w-full px-5 py-4 bg-slate-50 border border-slate-100 rounded-[1.25rem] text-sm font-semibold text-slate-700 input-focus"
                    placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”"
                  />
                </div>

                <div>
                  <label
                    class="block text-xs font-bold text-slate-400 mb-2 ml-1"
                    >ì´ë¦„</label
                  >
                  <input
                    type="text"
                    value="í™ê¸¸ë™"
                    class="w-full px-5 py-4 input-readonly rounded-[1.25rem] text-sm font-semibold"
                    readonly
                  />
                </div>
                <div>
                  <label
                    class="block text-xs font-bold text-slate-400 mb-2 ml-1"
                    >ìƒë…„ì›”ì¼</label
                  >
                  <input
                    type="text"
                    value="950101"
                    class="w-full px-5 py-4 input-readonly rounded-[1.25rem] text-sm font-semibold"
                    readonly
                  />
                </div>

                <div class="col-span-1 md:col-span-2">
                  <label
                    class="block text-xs font-bold text-slate-400 mb-2 ml-1"
                    >íœ´ëŒ€í° ë²ˆí˜¸ <span class="text-indigo-600">*</span></label
                  >
                  <div class="flex gap-2">
                    <input
                      type="tel"
                      id="phone"
                      value="010-1234-5678"
                      maxlength="13"
                      oninput="handlePhoneChange(this)"
                      class="flex-1 px-5 py-4 bg-slate-50 border border-slate-100 rounded-[1.25rem] text-sm font-semibold text-slate-700 input-focus transition-all"
                    />
                    <button
                      type="button"
                      id="btn-request-auth"
                      onclick="requestAuth()"
                      disabled
                      class="px-5 bg-slate-200 text-slate-400 text-xs font-bold rounded-[1.25rem] transition-colors whitespace-nowrap min-w-[100px]"
                    >
                      ì¸ì¦ë²ˆí˜¸ ì „ì†¡
                    </button>
                  </div>
                  <p
                    class="text-[10px] text-rose-500 ml-1 mt-1 hidden"
                    id="phone-msg"
                  >
                    ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ì¸ì¦ì„ ì§„í–‰í•´ì£¼ì„¸ìš”.
                  </p>
                </div>

                <div>
                  <label
                    class="block text-xs font-bold text-slate-400 mb-2 ml-1"
                    >ì´ë©”ì¼ ì£¼ì†Œ</label
                  >
                  <input
                    type="email"
                    value="pangyo_king@gmail.com"
                    class="w-full px-5 py-4 input-readonly rounded-[1.25rem] text-sm font-semibold"
                    readonly
                  />
                </div>
                <div>
                  <label
                    class="block text-xs font-bold text-slate-400 mb-2 ml-1"
                    >ì„±ë³„</label
                  >
                  <input
                    type="text"
                    value="ë‚¨ì„±"
                    class="w-full px-5 py-4 input-readonly rounded-[1.25rem] text-sm font-semibold"
                    readonly
                  />
                </div>

                <div class="col-span-1 md:col-span-2">
                  <label
                    class="block text-xs font-bold text-slate-400 mb-2 ml-1"
                    >í•œ ì¤„ ì†Œê°œ</label
                  >
                  <textarea
                    class="w-full px-5 py-4 bg-slate-50 border border-slate-100 rounded-[1.25rem] text-sm font-semibold text-slate-700 input-focus h-24 resize-none"
                    placeholder="ìì‹ ì„ ì§§ê²Œ ì†Œê°œí•´ ì£¼ì„¸ìš”."
                  >
ë§¤ì¼ íŒêµë¡œ ì¶œê·¼í•˜ëŠ” ì§ì¥ì¸ì…ë‹ˆë‹¤! ì¡°ìš©íˆ ê°€ëŠ” ê±¸ ì„ í˜¸í•´ìš”.</textarea
                  >
                </div>
              </div>
            </div>

            <div class="space-y-6">
              <h3
                class="text-lg font-bold text-slate-900 flex items-center gap-2"
              >
                <span class="w-1.5 h-6 bg-emerald-500 rounded-full"></span>
                ë™ìŠ¹ ìŠ¤íƒ€ì¼ ì„ íƒ
              </h3>
              <div class="flex flex-wrap gap-3">
                <div>
                  <input
                    type="checkbox"
                    id="style-1"
                    class="hidden tag-checkbox"
                    checked
                  />
                  <label
                    for="style-1"
                    class="px-5 py-3 border border-slate-100 bg-white rounded-2xl text-xs font-bold text-slate-500 cursor-pointer hover:border-indigo-200 transition-all block"
                    >ğŸ¤« ì¡°ìš©í•œ ì´ë™ ì„ í˜¸</label
                  >
                </div>
                <div>
                  <input
                    type="checkbox"
                    id="style-2"
                    class="hidden tag-checkbox"
                  />
                  <label
                    for="style-2"
                    class="px-5 py-3 border border-slate-100 bg-white rounded-2xl text-xs font-bold text-slate-500 cursor-pointer hover:border-indigo-200 transition-all block"
                    >ğŸµ ìŒì•… ê°ìƒ</label
                  >
                </div>
                <div>
                  <input
                    type="checkbox"
                    id="style-3"
                    class="hidden tag-checkbox"
                    checked
                  />
                  <label
                    for="style-3"
                    class="px-5 py-3 border border-slate-100 bg-white rounded-2xl text-xs font-bold text-slate-500 cursor-pointer hover:border-indigo-200 transition-all block"
                    >â˜• ì»¤í”¼ ì·¨ì‹ ê°€ëŠ¥</label
                  >
                </div>
                <div>
                  <input
                    type="checkbox"
                    id="style-4"
                    class="hidden tag-checkbox"
                  />
                  <label
                    for="style-4"
                    class="px-5 py-3 border border-slate-100 bg-white rounded-2xl text-xs font-bold text-slate-500 cursor-pointer hover:border-indigo-200 transition-all block"
                    >ğŸ’¬ ëŒ€í™” ì„ í˜¸</label
                  >
                </div>
                <div>
                  <input
                    type="checkbox"
                    id="style-5"
                    class="hidden tag-checkbox"
                    checked
                  />
                  <label
                    for="style-5"
                    class="px-5 py-3 border border-slate-100 bg-white rounded-2xl text-xs font-bold text-slate-500 cursor-pointer hover:border-indigo-200 transition-all block"
                    >ğŸš­ ê¸ˆì—° í•„ìˆ˜</label
                  >
                </div>
              </div>
            </div>

            <div class="h-10"></div>
          </div>
        </div>
      </div>
    </div>

    <div
      id="auth-modal-overlay"
      class="modal-overlay fixed inset-0 hidden flex items-center justify-center p-4 z-50"
    >
      <div
        class="modal-content bg-white w-full max-w-sm rounded-[2rem] shadow-2xl overflow-hidden"
      >
        <div class="p-6 text-center">
          <div
            class="w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center mx-auto mb-4"
          >
            <i data-lucide="send" class="w-6 h-6 text-indigo-600"></i>
          </div>
          <h3 class="text-lg font-bold text-slate-900">ì¸ì¦ë²ˆí˜¸ ë°œì†¡ ì™„ë£Œ</h3>
          <p class="text-sm text-slate-500 mt-1">
            ì…ë ¥í•˜ì‹  ë²ˆí˜¸ë¡œ ì¸ì¦ë²ˆí˜¸ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.
          </p>

          <div class="mt-6 mb-2 relative">
            <input
              type="text"
              id="auth-code-input"
              placeholder="ì¸ì¦ë²ˆí˜¸ 4ìë¦¬ (ì˜ˆ: 1234)"
              maxlength="4"
              class="w-full px-4 py-3.5 bg-slate-50 border border-slate-200 rounded-xl text-center font-bold text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent tracking-widest"
            />
          </div>

          <div class="text-sm font-bold text-rose-500 mb-6" id="timer-display">
            03:00
          </div>

          <div class="flex gap-3">
            <button
              onclick="closeAuthModal()"
              class="flex-1 py-3.5 rounded-xl border border-slate-200 text-slate-500 font-bold hover:bg-slate-50 transition-colors"
            >
              ì·¨ì†Œ
            </button>
            <button
              onclick="confirmAuthCode()"
              class="flex-1 py-3.5 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-100"
            >
              ì¸ì¦í•˜ê¸°
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      id="custom-alert-overlay"
      class="modal-overlay fixed inset-0 hidden flex items-center justify-center p-4 z-[60]"
    >
      <div
        class="modal-content bg-white w-full max-w-xs rounded-[2rem] shadow-2xl overflow-hidden p-6 text-center"
      >
        <div
          class="w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center mx-auto mb-4"
        >
          <i data-lucide="info" class="w-6 h-6 text-indigo-600"></i>
        </div>
        <h3 class="text-lg font-bold text-slate-900 mb-2">ì•Œë¦¼</h3>
        <p
          id="custom-alert-msg"
          class="text-sm text-slate-500 mb-6 leading-relaxed"
        ></p>
        <button
          onclick="closeCustomAlert()"
          class="w-full py-3.5 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-100 active:scale-95"
        >
          í™•ì¸
        </button>
      </div>
    </div>

    <script>
      // ë„¤ë¹„ê²Œì´ì…˜
      if (typeof loadNavbar === "function") loadNavbar("nav-mypage");
      lucide.createIcons();

      // ì „ì—­ ë³€ìˆ˜
      const originalPhone = "010-1234-5678"; // ì´ˆê¸° ì „í™”ë²ˆí˜¸
      let isPhoneVerified = true; // ì´ˆê¸°ì—” ì¸ì¦ëœ ìƒíƒœ
      let timerInterval;
      let alertCallback = null; // ì»¤ìŠ¤í…€ ì•Œë¦¼ ì½œë°± í•¨ìˆ˜ ì €ì¥ìš©

      // --- [NEW] ì»¤ìŠ¤í…€ ì•Œë¦¼ í•¨ìˆ˜ ---
      function showCustomAlert(msg, callback) {
        document.getElementById("custom-alert-msg").innerText = msg;
        document
          .getElementById("custom-alert-overlay")
          .classList.remove("hidden");
        alertCallback = callback; // í™•ì¸ ë²„íŠ¼ í´ë¦­ í›„ ì‹¤í–‰í•  í•¨ìˆ˜ ì €ì¥
      }

      function closeCustomAlert() {
        document.getElementById("custom-alert-overlay").classList.add("hidden");
        if (alertCallback) {
          alertCallback(); // ì½œë°± í•¨ìˆ˜ê°€ ìˆìœ¼ë©´ ì‹¤í–‰
          alertCallback = null;
        }
      }
      // ---------------------------

      // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
      document
        .getElementById("avatar-upload")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (event) {
              document.getElementById("profile-preview").src =
                event.target.result;
            };
            reader.readAsDataURL(file);
          }
        });

      // ì „í™”ë²ˆí˜¸ ì…ë ¥ ê°ì§€ ë° ìë™ í•˜ì´í”ˆ
      function handlePhoneChange(target) {
        // ìë™ í•˜ì´í”ˆ
        target.value = target.value
          .replace(/[^0-9]/g, "")
          .replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g, "$1-$2-$3")
          .replace(/(\-{1,2})$/g, "");

        const btn = document.getElementById("btn-request-auth");
        const msg = document.getElementById("phone-msg");

        // ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸
        if (target.value !== originalPhone) {
          isPhoneVerified = false;
          btn.disabled = false;
          btn.classList.remove("bg-slate-200", "text-slate-400");
          btn.classList.add("bg-slate-800", "text-white", "hover:bg-slate-700");
          msg.classList.remove("hidden");
        } else {
          isPhoneVerified = true;
          btn.disabled = true;
          btn.innerText = "ì¸ì¦ë²ˆí˜¸ ì „ì†¡";
          btn.classList.add("bg-slate-200", "text-slate-400");
          btn.classList.remove(
            "bg-slate-800",
            "text-white",
            "bg-emerald-500",
            "hover:bg-slate-700"
          );
          msg.classList.add("hidden");
        }
      }

      // ì¸ì¦ë²ˆí˜¸ ìš”ì²­ (ëª¨ë‹¬ ì—´ê¸°)
      function requestAuth() {
        const phone = document.getElementById("phone").value;
        if (phone.length < 12) {
          showCustomAlert("íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          return;
        }
        document
          .getElementById("auth-modal-overlay")
          .classList.remove("hidden");
        startTimer(180);
      }

      // íƒ€ì´ë¨¸ ë¡œì§
      function startTimer(duration) {
        let timer = duration,
          minutes,
          seconds;
        const display = document.getElementById("timer-display");
        clearInterval(timerInterval);

        timerInterval = setInterval(function () {
          minutes = parseInt(timer / 60, 10);
          seconds = parseInt(timer % 60, 10);
          minutes = minutes < 10 ? "0" + minutes : minutes;
          seconds = seconds < 10 ? "0" + seconds : seconds;
          display.textContent = minutes + ":" + seconds;

          if (--timer < 0) {
            clearInterval(timerInterval);
            showCustomAlert("ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.");
            closeAuthModal();
          }
        }, 1000);
      }

      function closeAuthModal() {
        document.getElementById("auth-modal-overlay").classList.add("hidden");
        document.getElementById("auth-code-input").value = "";
        clearInterval(timerInterval);
      }

      // ì¸ì¦ í™•ì¸
      function confirmAuthCode() {
        const code = document.getElementById("auth-code-input").value;
        if (code === "1234") {
          isPhoneVerified = true;

          // ëª¨ë‹¬ ë‹«ê¸° ë° UI ì—…ë°ì´íŠ¸
          closeAuthModal();
          const btn = document.getElementById("btn-request-auth");
          const msg = document.getElementById("phone-msg");
          btn.innerText = "ì¸ì¦ ì™„ë£Œ";
          btn.classList.remove(
            "bg-slate-800",
            "text-white",
            "hover:bg-slate-700"
          );
          btn.classList.add("bg-emerald-500", "text-white");
          btn.disabled = true;
          msg.classList.add("hidden");

          showCustomAlert("ì¸ì¦ë˜ì—ˆìŠµë‹ˆë‹¤.");
        } else {
          showCustomAlert("ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (í…ŒìŠ¤íŠ¸ ë²ˆí˜¸: 1234)");
        }
      }

      // ì €ì¥ ë²„íŠ¼ í•¸ë“¤ëŸ¬
      function handleSave() {
        if (!isPhoneVerified) {
          showCustomAlert("íœ´ëŒ€í° ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.");
          return;
        }
        // ì €ì¥ ì™„ë£Œ í›„ í˜ì´ì§€ ì´ë™ (ì½œë°± í•¨ìˆ˜ ì‚¬ìš©)
        showCustomAlert("íšŒì› ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!", function () {
          location.href = "mypage.html";
        });
      }
    </script>
  </body>
</html>
