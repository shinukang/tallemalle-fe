<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>íƒˆë˜ë§ë˜ - ë§¤ë„ˆ ì ìˆ˜ ë° ë¦¬ë·°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="nav.js"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap");

      :root {
        --tm-primary: #4f46e5;
        --tm-secondary: #eef2ff;
        --tm-danger: #f43f5e;
        --tm-danger-light: #fff1f2;
        --tm-star: #fbbf24;
      }

      body {
        font-family: "Pretendard", sans-serif;
        background-color: #f8fafc;
        overflow: hidden;
      }

      .glass-panel {
        background: rgba(255, 255, 255, 0.92);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 8px 32px rgba(30, 27, 75, 0.05);
      }

      .manner-score-bar {
        height: 12px;
        border-radius: 99px;
        background: #e2e8f0;
        overflow: hidden;
        position: relative;
      }

      .manner-score-fill {
        height: 100%;
        background: linear-gradient(90deg, #3b82f6, #4f46e5, #ef4444);
        transition: width 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        border-radius: 99px;
      }

      /* ë³„ì  ìŠ¤íƒ€ì¼: ì„ íƒ ì‹œ ë‚´ë¶€ê°€ ì±„ì›Œì§ */
      .star-btn {
        transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        color: #e2e8f0;
      }
      
      .star-btn.active {
        color: var(--tm-star);
      }
      
      .star-btn.active svg {
        fill: currentColor;
      }

      .star-btn:hover {
        transform: scale(1.2);
        color: var(--tm-star);
      }

      /* íƒœê·¸ ê³µí†µ ìŠ¤íƒ€ì¼ */
      .review-tag, .review-tag-bad {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        user-select: none;
        border: 1px solid #e2e8f0;
        background-color: white;
        display: inline-block;
      }

      /* ê¸ì • íƒœê·¸ í™œì„±í™” ìƒíƒœ */
      .review-tag:hover {
        border-color: var(--tm-primary);
        background-color: var(--tm-secondary);
        color: var(--tm-primary);
      }

      .review-tag.active {
        background-color: var(--tm-primary) !important;
        color: white !important;
        border-color: var(--tm-primary) !important;
        box-shadow: 0 4px 12px rgba(79, 70, 229, 0.25);
        transform: translateY(-2px);
      }

      /* ë¶€ì • íƒœê·¸ í™œì„±í™” ìƒíƒœ */
      .review-tag-bad:hover {
        border-color: var(--tm-danger);
        background-color: var(--tm-danger-light);
        color: var(--tm-danger);
      }

      .review-tag-bad.active {
        background-color: var(--tm-danger) !important;
        color: white !important;
        border-color: var(--tm-danger) !important;
        box-shadow: 0 4px 12px rgba(244, 63, 94, 0.25);
        transform: translateY(-2px);
      }

      .custom-scroll::-webkit-scrollbar {
        width: 6px;
      }

      .custom-scroll::-webkit-scrollbar-thumb {
        background: #e2e8f0;
        border-radius: 10px;
      }

      .nav-item.active {
        color: #4f46e5;
        background-color: #eef2ff;
      }

      .scale-up {
        animation: scaleUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      }

      @keyframes scaleUp {
        from { transform: scale(0.9); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
      }
    </style>
  </head>

  <body class="text-slate-800">
    <div class="flex h-screen p-4 gap-4">
      
      <!-- ë‚´ë¹„ê²Œì´ì…˜ ë°” ì»¨í…Œì´ë„ˆ -->
      <div id="navbar-container" class="w-20 h-full shrink-0 rounded-[2.5rem]"></div>

      <main class="flex-1 overflow-y-auto custom-scroll px-2">
        <div class="max-w-3xl mx-auto py-8 space-y-6">
          <header class="px-4 flex justify-between items-end">
            <div>
              <h1 class="text-2xl font-bold text-slate-900">í”„ë¡œí•„ ë° ë§¤ë„ˆ</h1>
            </div>
          </header>

          <!-- ë§¤ë„ˆ ì ìˆ˜ ì •ë³´ ì¹´ë“œ -->
          <section class="bg-white rounded-[2.5rem] p-8 shadow-sm border border-slate-100">
            <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-6 mb-8">
              <div class="flex items-center gap-6">
                <div class="w-24 h-24 rounded-[2rem] bg-indigo-50 border-4 border-white shadow-md flex items-center justify-center overflow-hidden">
                  <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="profile" />
                </div>
                <div>
                  <div class="flex items-center gap-2">
                    <h2 class="text-2xl font-bold text-slate-900">íŒêµë™ìŠ¹ì™•</h2>
                    <span class="bg-indigo-600 text-white text-[10px] px-2 py-0.5 rounded-lg font-bold">LV. 12</span>
                  </div>
                  <p class="text-slate-500 text-sm mt-1">ìµœê·¼ 30ì¼ ë™ì•ˆ 12ë²ˆ ë™ìŠ¹í–ˆì–´ìš”</p>
                </div>
              </div>
              <div class="text-left md:text-right">
                <div class="flex items-center justify-start md:justify-end gap-1 mb-1">
                  <span class="text-4xl font-black text-indigo-600 italic">72</span>
                  <span class="text-xl font-bold text-slate-300">ì </span>
                </div>
                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest block">ê¸°ë³¸ 50ì  ëŒ€ë¹„ +22ì </span>
              </div>
            </div>

            <div class="space-y-3">
              <div class="manner-score-bar">
                <div id="score-bar-fill" class="manner-score-fill" style="width: 0%"></div>
              </div>
              <div class="flex justify-between items-center text-[10px] font-bold text-slate-400 px-1">
                <span>ë§¤ë„ˆ í•˜ìœ„</span>
                <span>ë³´í†µ</span>
                <span class="text-indigo-600 flex items-center gap-1">
                  <i data-lucide="sparkles" class="w-3 h-3"></i> ë² ìŠ¤íŠ¸ ë§¤ë„ˆëŸ¬
                </span>
                <span>ë§¤ë„ˆ ìƒìœ„</span>
              </div>
            </div>
          </section>

          <!-- ë¦¬ë·° ì‘ì„± ì„¹ì…˜ -->
          <section class="bg-white rounded-[2.5rem] p-8 shadow-sm border border-slate-100">
            <h3 class="text-lg font-bold mb-8 flex items-center gap-2 text-indigo-900">
              <i data-lucide="message-square-quote" class="w-5 h-5 text-indigo-600"></i>
              ë™ìŠ¹ì€ ì–´ë– ì…¨ë‚˜ìš”?
            </h3>

            <!-- [ìˆ˜ì •ë¨] ì œëª© ì•„ì´ì½˜ ì •ë ¬ì— ë§ì¶˜ ì¢Œìš° íŒ¨ë”© ë™ì¼í™” (pl-7 -> px-7) -->
            <div class="space-y-10 px-7">
              <!-- ë³„ì  ì„ íƒ -->
              <div>
                <p class="text-[11px] font-bold text-slate-400 mb-4 uppercase tracking-widest">ë§Œì¡±ë„ë¥¼ ë³„ì ìœ¼ë¡œ í‘œí˜„í•´ì£¼ì„¸ìš”</p>
                <div id="star-rating" class="flex gap-2">
                  <button class="star-btn" data-value="1"><i data-lucide="star" class="w-8 h-8"></i></button>
                  <button class="star-btn" data-value="2"><i data-lucide="star" class="w-8 h-8"></i></button>
                  <button class="star-btn" data-value="3"><i data-lucide="star" class="w-8 h-8"></i></button>
                  <button class="star-btn" data-value="4"><i data-lucide="star" class="w-8 h-8"></i></button>
                  <button class="star-btn" data-value="5"><i data-lucide="star" class="w-8 h-8"></i></button>
                </div>
              </div>

              <!-- ê¸ì • í”¼ë“œë°± ì„¹ì…˜ -->
              <div>
                <p class="text-[11px] font-bold text-indigo-400 mb-4 uppercase tracking-widest">ì´ëŸ° ì ì´ ì¢‹ì•˜ì–´ìš”! (ìµœëŒ€ 3ê°œ)</p>
                <div class="flex flex-wrap gap-2">
                  <div class="review-tag px-5 py-2.5 rounded-2xl text-sm font-semibold">â° ì‹œê°„ ì•½ì† ì¤€ìˆ˜</div>
                  <div class="review-tag px-5 py-2.5 rounded-2xl text-sm font-semibold">ğŸ’¬ ëŒ€í™”ê°€ ì¦ê±°ì› ì–´ìš”</div>
                  <div class="review-tag px-5 py-2.5 rounded-2xl text-sm font-semibold">ğŸ¤« ì •ìˆ™í•˜ê²Œ ì´ë™í–ˆì–´ìš”</div>
                  <div class="review-tag px-5 py-2.5 rounded-2xl text-sm font-semibold">âš¡ ì‘ë‹µì´ ë¹¨ë¼ìš”</div>
                  <div class="review-tag px-5 py-2.5 rounded-2xl text-sm font-semibold">ğŸ¤ ë°°ë ¤ì‹¬ì´ ë„˜ì³ìš”</div>
                </div>
              </div>

              <!-- ë¶€ì • í”¼ë“œë°± ì„¹ì…˜ -->
              <div>
                <p class="text-[11px] font-bold text-rose-400 mb-4 uppercase tracking-widest">ì´ëŸ° ì ì´ ì‹«ì—ˆì–´ìš” (ìµœëŒ€ 3ê°œ)</p>
                <div class="flex flex-wrap gap-2">
                  <div class="review-tag-bad px-5 py-2.5 rounded-2xl text-sm font-semibold">âŒ› ì‹œê°„ ì•½ì† ë¯¸ì¤€ìˆ˜</div>
                  <div class="review-tag-bad px-5 py-2.5 rounded-2xl text-sm font-semibold">ğŸ“µ ì—°ë½ì´ ì˜ ì•ˆë¼ìš”</div>
                  <div class="review-tag-bad px-5 py-2.5 rounded-2xl text-sm font-semibold">ğŸ’¬ ëŒ€í™”ê°€ ë¶ˆí¸í–ˆì–´ìš”</div>
                  <div class="review-tag-bad px-5 py-2.5 rounded-2xl text-sm font-semibold">ğŸš¬ ë¶ˆì¾Œí•œ ëƒ„ìƒˆ/í¡ì—°</div>
                  <div class="review-tag-bad px-5 py-2.5 rounded-2xl text-sm font-semibold">ğŸ’¸ ì •ì‚°ì´ ëŠ¦ì–´ìš”</div>
                </div>
              </div>

              <!-- ììœ  ê²½í—˜ ì‘ì„± -->
              <div>
                <textarea id="review-text" class="w-full h-32 p-6 bg-slate-50 border border-slate-100 rounded-[2rem] focus:outline-none focus:ring-4 focus:ring-indigo-500/5 transition-all text-sm resize-none" placeholder="ë™ìŠ¹ ê²½í—˜ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”(ì„ íƒ)"></textarea>
              </div>

              <!-- ì‚¬ìš©ì ì°¨ë‹¨ ë²„íŠ¼ - í…ìŠ¤íŠ¸ ì…ë ¥ì°½ê³¼ ë“±ë¡ ë²„íŠ¼ ì‚¬ì´ -->
              <div class="flex justify-end px-2">
                <button id="block-user-btn" class="flex items-center gap-2 px-4 py-2 text-xs font-bold text-rose-500 hover:bg-rose-50 rounded-xl transition-all border border-transparent hover:border-rose-100">
                  <i data-lucide="ban" class="w-4 h-4"></i>
                  ì´ ì‚¬ìš©ì ì°¨ë‹¨í•˜ê¸°
                </button>
              </div>

              <!-- ì œì¶œ ë²„íŠ¼ -->
              <button id="submit-review-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-5 rounded-3xl shadow-xl shadow-indigo-100 transition-all active:scale-[0.98]">
                í›„ê¸° ë“±ë¡í•˜ê¸°
              </button>
            </div>
          </section>
        </div>
      </main>
    </div>

    <script>
      // ë‚´ë¹„ê²Œì´ì…˜ í™œì„±í™”
      if (typeof loadNavbar === 'function') loadNavbar('nav-review');
      lucide.createIcons();

      // ë§¤ë„ˆ ì ìˆ˜ ë°” ì• ë‹ˆë©”ì´ì…˜
      window.onload = () => {
        setTimeout(() => {
          const fill = document.getElementById("score-bar-fill");
          if (fill) fill.style.width = "72%";
        }, 300);
      };

      // ë³„ì  ë¡œì§
      let selectedStars = 0;
      const stars = document.querySelectorAll('.star-btn');
      stars.forEach(star => {
        star.addEventListener('click', () => {
          const val = parseInt(star.getAttribute('data-value'));
          selectedStars = val;
          updateStars(val);
        });
      });

      function updateStars(val) {
        stars.forEach((s, idx) => {
          if (idx < val) {
            s.classList.add('active');
          } else {
            s.classList.remove('active');
          }
        });
      }

      // ê³µí†µ ëª¨ë‹¬ ìƒì„± í•¨ìˆ˜
      const showModal = ({ icon, iconColor, iconBg, title, message, buttonText, buttonClass, onConfirm }) => {
        const modal = document.createElement('div');
        modal.className = "fixed inset-0 bg-slate-900/60 backdrop-blur-md flex items-center justify-center z-[100] p-6";
        modal.innerHTML = `
          <div class="bg-white rounded-[2.5rem] p-8 max-w-sm w-full text-center shadow-2xl scale-up">
            <div class=\"w-16 h-16 ${iconBg} ${iconColor} rounded-full flex items-center justify-center mx-auto mb-6\">
              <i data-lucide=\"${icon}\" class=\"w-8 h-8\"></i>
            </div>
            <h3 class=\"text-xl font-bold text-slate-900 mb-2\">${title}</h3>
            <p class=\"text-sm text-slate-500 mb-8 leading-relaxed\">${message}</p>
            <button id=\"modal-confirm-btn\" class=\"w-full py-4 ${buttonClass} text-white rounded-2xl font-bold text-sm transition-all active:scale-95\">
              ${buttonText}
            </button>
          </div>
        `;
        document.body.appendChild(modal);
        lucide.createIcons();

        document.getElementById('modal-confirm-btn').addEventListener('click', () => {
          document.body.removeChild(modal);
          if (onConfirm) onConfirm();
        });
        
        return modal;
      };

      // íƒœê·¸ í† ê¸€ ë° ì¹´í…Œê³ ë¦¬ë³„ ìµœëŒ€ ì„ íƒ ê°œìˆ˜(3ê°œ) ì œí•œ ë¡œì§
      const setupToggles = (selector) => {
        document.querySelectorAll(selector).forEach((tag) => {
          tag.addEventListener("click", () => {
            const activeInCategory = document.querySelectorAll(`${selector}.active`);
            if (tag.classList.contains('active')) {
              tag.classList.remove('active');
            } else {
              if (activeInCategory.length >= 3) {
                const categoryName = selector === '.review-tag' ? 'ì¢‹ì•˜ë˜ ì ' : 'ì‹«ì—ˆë˜ ì ';
                showModal({
                  icon: 'alert-circle',
                  iconColor: 'text-amber-500',
                  iconBg: 'bg-amber-100',
                  title: 'ì„ íƒ ê°œìˆ˜ ì´ˆê³¼',
                  message: `${categoryName}ì€ ìµœëŒ€ 3ê°œê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`,
                  buttonText: 'í™•ì¸',
                  buttonClass: 'bg-slate-900 hover:bg-slate-800'
                });
                return;
              }
              tag.classList.add('active');
            }
          });
        });
      };

      setupToggles(".review-tag");
      setupToggles(".review-tag-bad");

      // í›„ê¸° ë“±ë¡ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      const submitBtn = document.getElementById('submit-review-btn');
      submitBtn.addEventListener('click', () => {
        const selectedTags = document.querySelectorAll('.review-tag.active, .review-tag-bad.active');
        
        if (selectedStars === 0) {
          showModal({
            icon: 'star',
            iconColor: 'text-amber-500',
            iconBg: 'bg-amber-50',
            title: 'ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”',
            message: 'ë™ìŠ¹ ë§Œì¡±ë„ë¥¼ ë³„ì ìœ¼ë¡œ ë¨¼ì € í‘œí˜„í•´ì£¼ì„¸ìš”.',
            buttonText: 'í™•ì¸',
            buttonClass: 'bg-slate-900 hover:bg-slate-800'
          });
          return;
        }

        if (selectedTags.length === 0) {
          showModal({
            icon: 'alert-circle',
            iconColor: 'text-amber-500',
            iconBg: 'bg-amber-100',
            title: 'íƒœê·¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”',
            message: 'ìƒëŒ€ë°©ì˜ íŠ¹ì§•ì„ ë‚˜íƒ€ë‚´ëŠ” íƒœê·¸ë¥¼ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.',
            buttonText: 'í™•ì¸',
            buttonClass: 'bg-slate-900 hover:bg-slate-800'
          });
          return;
        }

        showModal({
          icon: 'check-circle',
          iconColor: 'text-emerald-600',
          iconBg: 'bg-emerald-100',
          title: 'í›„ê¸° ë“±ë¡ ì™„ë£Œ',
          message: 'ì†Œì¤‘í•œ ì˜ê²¬ ê°ì‚¬í•©ë‹ˆë‹¤! ì „ì†¡ëœ í›„ê¸°ëŠ” ìƒëŒ€ë°©ì˜ ë§¤ë„ˆ ì ìˆ˜ì— ë°˜ì˜ë©ë‹ˆë‹¤.',
          buttonText: 'í™•ì¸',
          buttonClass: 'bg-indigo-600 hover:bg-indigo-700',
          onConfirm: () => {
            window.location.href = 'mypage.html';
          }
        });
      });

      // ì‚¬ìš©ì ì°¨ë‹¨ ë²„íŠ¼ ì´ë²¤íŠ¸
      const blockBtn = document.getElementById('block-user-btn');
      blockBtn.addEventListener('click', () => {
        const confirmModal = document.createElement('div');
        confirmModal.className = "fixed inset-0 bg-slate-900/60 backdrop-blur-md flex items-center justify-center z-[100] p-6";
        confirmModal.innerHTML = `
          <div class="bg-white rounded-[2.5rem] p-8 max-w-sm w-full text-center shadow-2xl scale-up">
            <div class=\"w-16 h-16 bg-rose-100 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6\">
              <i data-lucide=\"user-x\" class=\"w-8 h-8\"></i>
            </div>
            <h3 class=\"text-xl font-bold text-slate-900 mb-2\">ì‚¬ìš©ìë¥¼ ì°¨ë‹¨í• ê¹Œìš”?</h3>
            <p class=\"text-sm text-slate-500 mb-8 leading-relaxed\">ì°¨ë‹¨í•˜ë©´ ë” ì´ìƒ ì´ ì‚¬ìš©ìì™€ ë§¤ì¹­ë˜ì§€ ì•Šìœ¼ë©° ëŒ€í™”ê°€ ì œí•œë©ë‹ˆë‹¤.</p>
            <div class=\"flex gap-3\">
              <button id=\"cancel-block\" class=\"flex-1 py-4 bg-slate-100 text-slate-600 rounded-2xl font-bold text-sm hover:bg-slate-200 transition-all\">
                ì·¨ì†Œ
              </button>
              <button id=\"confirm-block\" class=\"flex-1 py-4 bg-rose-500 text-white rounded-2xl font-bold text-sm hover:bg-rose-600 transition-all shadow-lg shadow-rose-100\">
                ì°¨ë‹¨í•˜ê¸°
              </button>
            </div>
          </div>
        `;
        document.body.appendChild(confirmModal);
        lucide.createIcons();

        document.getElementById('cancel-block').addEventListener('click', () => {
          document.body.removeChild(confirmModal);
        });

        document.getElementById('confirm-block').addEventListener('click', () => {
          confirmModal.innerHTML = `
            <div class=\"bg-white rounded-[2.5rem] p-8 max-w-sm w-full text-center shadow-2xl scale-up\">
              <div class=\"w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6\">
                <i data-lucide=\"check-circle\" class=\"w-8 h-8\"></i>
              </div>
              <h3 class=\"text-xl font-bold text-slate-900 mb-2\">ì°¨ë‹¨ ì™„ë£Œ</h3>
              <p class=\"text-sm text-slate-500 mb-8\">í•´ë‹¹ ì‚¬ìš©ìê°€ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
              <button onclick=\"window.location.reload()\" class=\"w-full py-4 bg-slate-900 text-white rounded-2xl font-bold text-sm\">
                í™•ì¸
              </button>
            </div>
          `;
          lucide.createIcons();
        });
      });
    </script>
  </body>
</html>